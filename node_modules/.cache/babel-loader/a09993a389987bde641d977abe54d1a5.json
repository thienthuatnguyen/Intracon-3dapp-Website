{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/mac/Documents/Intracon-3dapp-Website/app/src/pages/index.js\";\nimport React from \"react\";\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport BackGround from '../static/imgs/home/home-bg.jpg';\nimport Authorization from '../services/authorization';\nimport { setAccessToken, getAccessToken, setCookie, removeAccessToken } from '../utils/storage';\nimport Loading from '../components/Loading';\nimport SideMenu from '../components/Layout/SideMenu';\nimport LogoHP from '../static/imgs/hp-logo.png';\nimport BackGroundContent from '../components/UI/BackGroundContent';\n\nclass HomePage extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      error: false,\n      errorText: '',\n      loading: true\n    });\n  }\n\n  static async getInitialProps({\n    req,\n    query,\n    params\n  }) {\n    if (req) {\n      return {\n        query: req.query,\n        params: req.params\n      };\n    }\n\n    return {\n      query,\n      params\n    };\n  }\n\n  componentDidMount() {\n    const query = this.props.query;\n    const token = getAccessToken();\n\n    if (query.code) {\n      try {\n        Authorization.token({\n          code: query.code,\n          type: 'web'\n        }).then(response => {\n          // success login\n          if (response.data.error || typeof response.data === 'string' && response.data.indexOf('INVALID_TOKEN') != -1) {\n            this.resetLogin(true, 'Your Login is invalid. Please try again');\n          } else if (response.data && response.data.access_token) {\n            const sessionExpire = new Date(new Date().getTime() + 90000000);\n            setAccessToken(response.data.access_token, {\n              expires: sessionExpire,\n              path: '/'\n            });\n            setCookie('email', response.data.email, {\n              expires: sessionExpire,\n              path: '/'\n            });\n            window.location.href = '/';\n          } else {\n            this.resetLogin(true, 'Your account: (email address) does not exist. Please contact 3D website Admin');\n          }\n        });\n      } catch (e) {\n        this.resetLogin(true, 'An error occurred. The connection timed out due to inactivity or the server is unable to respond.');\n      }\n    } else if (!token) {\n      Authorization.authen('web').then(response => {\n        window.location.href = response.data;\n      });\n    } else {\n      this.setState({\n        error: false,\n        loading: false\n      });\n    }\n  }\n\n  resetLogin(error, errorText) {\n    this.setState({\n      error: error,\n      errorText: errorText,\n      loading: false\n    });\n    removeAccessToken();\n    setTimeout(() => {\n      window.location.href = '/';\n    }, 5000);\n  }\n\n  render() {\n    const _this$state = this.state,\n          loading = _this$state.loading,\n          error = _this$state.error,\n          errorText = _this$state.errorText;\n\n    if (error) {\n      return React.createElement(WrapperErrorPage, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"logo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: LogoHP,\n        alt: \"logo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"content-error\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, errorText))));\n    } else {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, loading && React.createElement(Loading, {\n        showLoading: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }), !loading && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(SideMenu, {\n        staticValue: \"homepage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(Wrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }), React.createElement(BackGroundContent, {\n        id: \"bgMainPage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      })));\n    }\n  }\n\n}\n\nHomePage.propTypes = {\n  query: PropTypes.object\n};\nconst Wrapper = styled.div.withConfig({\n  displayName: \"pages__Wrapper\",\n  componentId: \"sc-1yi3e20-0\"\n})([\"background-image:url(\", \");background-repeat:no-repeat;background-size:cover;background-position:center center;display:flex;flex:1 1 100%;\"], BackGround);\nconst WrapperErrorPage = styled.div.withConfig({\n  displayName: \"pages__WrapperErrorPage\",\n  componentId: \"sc-1yi3e20-1\"\n})([\"display:flex;flex-direction:column;width:100%;.logo{display:flex;flex-direction:column;align-items:center;margin-top:60px;img{object-fit:contain;width:50px;}}.content-error{display:flex;justify-content:center;margin-top:60px;.box{width:400px;padding:50px;box-shadow:0 4px 8px 0 rgba(0,0,0,0.12),0 2px 4px 0 rgba(0,0,0,0.08);background-color:#fff;.text{color:#000;font-size:26px;font-family:\", \";}.ression{margin-top:40px;}}}\"], props => props.theme.bodyFont);\nexport default HomePage;","map":{"version":3,"sources":["/Users/mac/Documents/Intracon-3dapp-Website/app/src/pages/index.js"],"names":["styled","PropTypes","BackGround","Authorization","setAccessToken","getAccessToken","setCookie","removeAccessToken","Loading","SideMenu","LogoHP","BackGroundContent","HomePage","React","Component","error","errorText","loading","getInitialProps","req","query","params","componentDidMount","props","token","code","type","then","response","data","indexOf","resetLogin","access_token","sessionExpire","Date","getTime","expires","path","email","window","location","href","e","authen","setState","setTimeout","render","state","propTypes","object","Wrapper","div","WrapperErrorPage","theme","bodyFont"],"mappings":"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","sourcesContent":["import styled from 'styled-components'\nimport PropTypes from 'prop-types'\nimport BackGround from '../static/imgs/home/home-bg.jpg'\nimport Authorization from '../services/authorization'\nimport { setAccessToken, getAccessToken, setCookie, removeAccessToken } from '../utils/storage'\nimport Loading from '../components/Loading'\nimport SideMenu from '../components/Layout/SideMenu'\nimport LogoHP from '../static/imgs/hp-logo.png'\nimport BackGroundContent from '../components/UI/BackGroundContent'\n\nclass HomePage extends React.Component {\n\n  state = {\n    error: false,\n    errorText: '',\n    loading: true\n  }\n\n  static async getInitialProps({ req, query, params }) {\n    if (req) {\n      return { query: req.query, params: req.params }\n    }\n\n    return { query, params }\n  }\n\n  componentDidMount() {\n    const { query } = this.props\n    const token = getAccessToken()\n    if (query.code) {\n      try {\n        Authorization.token({ code: query.code, type: 'web' }).then(\n          response => {\n            // success login\n            if (response.data.error ||\n                (typeof response.data === 'string' && response.data.indexOf('INVALID_TOKEN') != -1)) {\n              this.resetLogin(true, 'Your Login is invalid. Please try again')\n            } else if (response.data && response.data.access_token) {\n              const sessionExpire = new Date(new Date().getTime() + 90000000)\n              setAccessToken(response.data.access_token, { expires: sessionExpire, path: '/' })\n              setCookie('email', response.data.email, { expires: sessionExpire, path: '/' })\n              window.location.href = '/'\n            } else {\n              this.resetLogin(true, 'Your account: (email address) does not exist. Please contact 3D website Admin')\n            }\n          }\n        )\n      } catch(e) {\n        this.resetLogin(\n          true,\n          'An error occurred. The connection timed out due to inactivity or the server is unable to respond.')\n      }\n    } else if (!token) {\n      Authorization.authen('web').then(response => {\n        window.location.href = response.data\n      })\n    } else {\n      this.setState({ error: false, loading: false })\n    }\n  }\n\n  resetLogin(error, errorText) {\n    this.setState({ error: error, errorText: errorText, loading: false })\n    removeAccessToken()\n    setTimeout(() => {\n      window.location.href = '/'\n    }, 5000)\n  }\n\n  render() {\n    const { loading, error, errorText } = this.state\n    if (error) {\n      return (\n        <WrapperErrorPage>\n          <div className='logo'>\n            <img src={LogoHP} alt='logo' />\n          </div>\n          <div className='content-error'>\n            <div className='box'>\n              <div className='text'>\n                {errorText}\n              </div>\n            </div>\n          </div>\n        </WrapperErrorPage>\n      )\n    }\n    else {\n      return (\n        <React.Fragment>\n          {\n            loading && <Loading showLoading />\n          }\n          {\n            !loading &&\n            <React.Fragment>\n              <SideMenu staticValue='homepage' />\n              <Wrapper />\n              <BackGroundContent id='bgMainPage' />\n            </React.Fragment>\n          }\n        </React.Fragment>\n      )\n    }\n  }\n}\n\nHomePage.propTypes = {\n  query: PropTypes.object\n}\n\n\nconst Wrapper = styled.div`\n  background-image: url(${BackGround});\n  background-repeat: no-repeat;\n  background-size: cover;\n  background-position: center center;\n  display: flex;\n  flex: 1 1 100%;\n`\nconst WrapperErrorPage = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n\n  .logo {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-top: 60px;\n\n    img {\n      object-fit: contain;\n      width: 50px;\n    }\n  }\n\n  .content-error {\n    display: flex;\n    justify-content: center;\n    margin-top: 60px;\n\n    .box {\n      width: 400px;\n      padding: 50px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.12), 0 2px 4px 0 rgba(0, 0, 0, 0.08);\n      background-color: #fff;\n\n      .text {\n        color: #000;\n        font-size: 26px;\n        font-family: ${props => props.theme.bodyFont};\n      }\n\n      .ression {\n        margin-top: 40px;\n      }\n    }\n  }\n`\n\nexport default HomePage\n"]},"metadata":{},"sourceType":"module"}