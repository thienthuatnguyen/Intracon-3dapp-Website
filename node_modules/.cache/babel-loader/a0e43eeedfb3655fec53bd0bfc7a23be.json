{"ast":null,"code":"import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/mac/Documents/Intracon-3dapp-Website/app/src/components/Layout/SideMenu.js\";\n\n/* eslint-disable no-loops/no-loops */\n\n/* eslint-disable no-undef */\nimport styled from 'styled-components';\nimport React, { Component } from 'react';\nimport propTypes from 'prop-types';\nimport ToggleContentParent from '../ToggleContentParent';\nimport Menu from '../../services/menu';\nimport Image from '../../services/image';\nimport Authorization from '../../services/authorization';\nimport Document from '../../services/document';\nimport { removeAccessToken } from '../../utils/storage';\nimport RowItem from '../UI/ItemSideMenu/RowItem';\nimport RowItemDocument from '../UI/ItemSideMenu/RowItemDocument';\nimport TextDocument from '../UI/ItemSideMenu/TextDocument';\nimport RowItemSub from '../UI/ItemSideMenu/RowItemSub';\nimport TextSub from '../UI/ItemSideMenu/TextSub';\nimport Icon from '../UI/ItemSideMenu/Icon';\nimport Text from '../UI/ItemSideMenu/Text';\nimport NewItem from '../UI/ItemSideMenu/NewItem';\nimport Language from '../UI/ItemSideMenu/Language';\nimport { IconLang, ContactIcon, FavoritesIcon } from '../Icons';\nimport IconDocument from '../IconDocument';\nimport PopupChangeLanguage from '../PopupChangeLanguage';\n\nclass SideMenu extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      rawMenus: '',\n      openId: '',\n      menus: [],\n      layers: []\n    });\n\n    _defineProperty(this, \"setWrapperRef\", node => {\n      this.wrapperRef = node;\n    });\n\n    _defineProperty(this, \"getCallBack\", async (value, animation, hashing) => {\n      await this.getCallBackChild(value, 0, animation, hashing);\n      this.setState({\n        openId: value\n      });\n    });\n\n    _defineProperty(this, \"getCallBackChild\", async (value, layerIndex, animation, hashing) => {\n      const _this$state = this.state,\n            rawMenus = _this$state.rawMenus,\n            layers = _this$state.layers;\n      const menu = rawMenus.filter(menu => menu.id == value)[0];\n      const menus = rawMenus.filter(menu => menu.parentMenuId == value);\n      const documents = menu.documentList;\n      const isCalendar = menu.name.toLowerCase().indexOf('3dp training') == -1 ? false : true; // change hash location so it can perform go back function\n\n      if (!hashing) {\n        const hashes = layerIndex == 0 ? [] : location.hash.split('/');\n\n        if (hashes[layerIndex]) {\n          hashes[layerIndex] = value;\n        } else {\n          hashes.push(value);\n        }\n\n        location.hash = hashes.join('/');\n      }\n\n      if (!isCalendar && menus.length == 0 && documents.length == 0) {\n        if (layers.length > 0 && layers[layerIndex - 1]) {\n          layers[layerIndex - 1].openId = value;\n        }\n\n        if (layerIndex == 0) {\n          const el = document.getElementById('bgMainPage');\n          Image.getUrl(value).then(img => {\n            el.style.backgroundImage = `url('${img.data}')`;\n            el.style.display = 'block';\n          });\n        }\n\n        layers.splice(layerIndex);\n        this.setState({\n          layers\n        });\n      } else {\n        const num = layerIndex - 1;\n\n        if (layerIndex > 2) {\n          if (animation && num + 1 == layers.length) {\n            $(`#layer${num}`).css({\n              'z-index': 1100\n            });\n            await $(`#layer${num}`).animate({\n              'left': '-=200px'\n            }).promise();\n\n            if (layers[num]) {\n              layers[num].styleIndex = 1;\n            }\n          }\n\n          this.setDataState(layers, value, layerIndex, animation);\n        } else {\n          this.setDataState(layers, value, layerIndex, animation);\n        }\n      }\n    });\n\n    _defineProperty(this, \"setDataState\", (stateLayers, value, layerIndex, animation) => {\n      const rawMenus = this.state.rawMenus;\n      const layers = [...stateLayers];\n      const menu = rawMenus.filter(menu => menu.id == value)[0];\n      const menus = rawMenus.filter(menu => menu.parentMenuId == value);\n      const documents = menu.documentList;\n\n      if (layerIndex == 0) {\n        // click on non main page (contact, setting, calendar pages)\n        const el = document.getElementById('bgMainPage'); // change background if it is on main page\n\n        Image.getUrl(value).then(img => {\n          el.style.backgroundImage = `url('${img.data}')`;\n          el.style.display = 'block';\n        });\n      }\n\n      layers.splice(layerIndex); // sort menus by position\n\n      const docData = documents.sort((a, b) => a.position - b.position);\n      const theCalendar = menu.name.toLowerCase().indexOf('3dp training') == -1 ? false : true;\n      layers.push({\n        id: `layer${layerIndex}`,\n        index: layerIndex,\n        styleIndex: layerIndex > 2 ? 2 : layerIndex,\n        parentMenuId: value,\n        menus: menus,\n        documents: docData,\n        isCalendar: theCalendar,\n        isActive: true\n      });\n      const lastIndex = layerIndex == 0 ? layerIndex : layerIndex - 1;\n      layers[lastIndex].openId = value;\n      let layerLength = layers.length;\n      this.setState({\n        layers\n      }, () => {\n        // perform slide in / slide out effect\n        let numId = layerIndex.toString();\n        let idLayer = '#layer' + numId;\n\n        for (let x = layerIndex; x < layerLength; x++) {\n          $(`#side-menu-user #layer${x}`).css({\n            display: 'none',\n            width: 0\n          });\n        }\n\n        if (animation) {\n          $(`#side-menu-user ${idLayer}`).delay(300).css({\n            display: 'block'\n          }).animate({\n            width: 300\n          });\n        } else {\n          $(`#side-menu-user ${idLayer}`).css({\n            display: 'block',\n            width: 300\n          });\n        }\n      });\n    });\n\n    _defineProperty(this, \"handleClickOutside\", event => {\n      if (this.wrapperRef && !this.wrapperRef.contains(event.target)) {\n        var elements = document.querySelectorAll('.sub-menu-child');\n\n        for (let i = 0; i < elements.length; i++) {\n          elements[i].classList.remove('open');\n        }\n      }\n    });\n  }\n\n  async componentDidMount() {\n    document.addEventListener('mousedown', this.handleClickOutside);\n    const menus = [];\n    const response = await Menu.getAll();\n    response.data.sort((a, b) => a.position - b.position);\n    response.data.forEach(item => {\n      item.viewed = true;\n\n      if (!item.parentMenuId) {\n        menus.push(item);\n      }\n    });\n    this.setState({\n      menus,\n      rawMenus: response.data\n    }, async () => {\n      $('.bottom-item').show().css('display', 'flex'); // parse the hashes and restore menu states\n\n      const hashes = location.hash.split('/');\n\n      for (let x = 0; x < hashes.length; x++) {\n        hashes[x] = hashes[x].replace('#', '');\n\n        if (hashes[x]) {\n          if (x == 0) {\n            await this.getCallBack(hashes[x], false, true);\n          } else {\n            await this.getCallBackChild(hashes[x], x, false, true);\n          }\n        }\n      } // build viewed data\n\n\n      this.buildViewedDocument();\n    });\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleClickOutside);\n  }\n\n  buildViewedDocument() {\n    const rawMenus = this.state.rawMenus;\n    const documents = rawMenus.map(menu => menu.documentList).flat();\n    documents.forEach(doc => {\n      if (!doc.viewed) {\n        let finalMenu = doc.menuId; // set new icon to the parent\n\n        while (finalMenu) {\n          rawMenus.forEach(menu => {\n            if (menu.id == finalMenu) {\n              menu.viewed = false;\n              finalMenu = menu.parentMenuId;\n            }\n          });\n        }\n      }\n    });\n    this.setState({\n      rawMenus\n    });\n  }\n\n  closeAllLayer() {\n    var elements = document.querySelectorAll('.sub-menu-child');\n\n    for (let i = 1; i < elements.length; i++) {\n      elements[i].classList.remove('open');\n    }\n  }\n\n  logout() {\n    Authorization.logout('web').then(response => {\n      removeAccessToken();\n\n      if (response.data != 'OK') {\n        window.location = response.data;\n      } else {\n        window.location = '/';\n      }\n    });\n  }\n\n  openCalendar() {\n    window.location.href = '/calendar';\n  }\n\n  openDocument(menu, document) {\n    Document.viewedDocuments(document).then(() => {\n      window.location.href = `/content-viewer?menuId=${menu}&document=${document}`;\n    });\n  }\n\n  async openFavorites() {\n    const _this$state2 = this.state,\n          layers = _this$state2.layers,\n          rawMenus = _this$state2.rawMenus;\n    const documents = await Document.favoriteDocuments();\n    const temp = rawMenus.map(menu => menu.documentList.map(item => item.id)).flat();\n    const result = [];\n\n    if (temp) {\n      documents.data.forEach(item => {\n        if (temp.includes(item.documentDTO.id)) {\n          result.push(item.documentDTO);\n        }\n      });\n    }\n\n    layers.splice(0);\n    layers.push({\n      id: 'layer0',\n      index: 0,\n      styleIndex: 0,\n      parentMenuId: 'favorite',\n      menus: [],\n      documents: result,\n      isActive: true\n    });\n    this.setState({\n      openId: 'fav',\n      layers\n    }, () => {\n      // perform slide in / slide out effect for favorite page\n      let idLayer = '#layer0';\n      $(`#side-menu-user ${idLayer}`).css({\n        display: 'none',\n        width: 0\n      });\n      $(`#side-menu-user ${idLayer}`).delay(300).css({\n        display: 'block'\n      }).animate({\n        width: 300\n      });\n    });\n  }\n\n  openContactPage() {\n    window.location.href = '/contact';\n  }\n\n  render(props) {\n    const staticValue = this.props.staticValue;\n    const _this$state3 = this.state,\n          openId = _this$state3.openId,\n          menus = _this$state3.menus,\n          layers = _this$state3.layers;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, React.createElement(WrapperSideMenu, {\n      id: \"side-menu-user\",\n      ref: this.setWrapperRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, menus.map(item => React.createElement(ToggleContentParent, {\n      key: item.id,\n      imageId: item.primaryIconId,\n      title: item.name,\n      id: item.id,\n      keyId: openId,\n      getData: this.getCallBack,\n      viewed: item.viewed,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    })), React.createElement(RowItem, {\n      className: openId == 'fav' ? 'active row-item bottom-item' : 'row-item bottom-item',\n      onClick: () => this.openFavorites(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(FavoritesIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    })), React.createElement(Text, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"Favorites\")), React.createElement(RowItem, {\n      className: staticValue === 'contact' ? 'active row-item bottom-item' : 'row-item bottom-item',\n      onClick: () => this.openContactPage(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, React.createElement(ContactIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    })), React.createElement(Text, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, \"Contact\")), React.createElement(WrapperSideMenuPlayer, {\n      key: '1',\n      id: 'layer1',\n      style: {\n        left: `100%`,\n        zIndex: 1000\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, React.createElement(RowItemDocument, {\n      style: {\n        backgroundColor: '#fff'\n      },\n      role: \"button\",\n      className: 'row-item',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, React.createElement(IconDocument, {\n      documentType: 'pdf',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    })), React.createElement(TextDocument, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, \"1234 fsf \"), React.createElement(Language, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, React.createElement(IconLang, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    })), React.createElement(NewItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }), React.createElement(PopupChangeLanguage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }))), layers && layers.map(layer => React.createElement(WrapperSideMenuPlayer, {\n      key: layer.id,\n      id: 'layer' + layer.index,\n      style: {\n        left: `${(layer.styleIndex + 1) * 100}%`,\n        zIndex: 1000 - layer.styleIndex\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340\n      },\n      __self: this\n    }, layer.isCalendar && React.createElement(RowItemSub, {\n      role: \"button\",\n      className: staticValue === 'calendar' ? 'active row-item' : 'row-item',\n      key: \"calendar\",\n      onClick: e => this.openCalendar(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347\n      },\n      __self: this\n    }, React.createElement(TextSub, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, \"WW 3DP Training Calendar\")), layer.menus && layer.menus.map(menu => React.createElement(RowItemSub, {\n      role: \"button\",\n      className: layer.openId == menu.id ? 'active row-item' : 'row-item',\n      key: menu.id,\n      onClick: e => this.getCallBackChild(menu.id, layer.index + 1, true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(TextSub, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364\n      },\n      __self: this\n    }, menu.name), !menu.viewed && React.createElement(NewItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }))), layer.documents && layer.documents.map(document => React.createElement(RowItemDocument, {\n      role: \"button\",\n      className: layer.openId == document.id ? 'active row-item' : 'row-item',\n      key: document.id,\n      onClick: e => this.openDocument(layer.parentMenuId, document.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377\n      },\n      __self: this\n    }, React.createElement(IconDocument, {\n      documentType: document.documentType ? document.documentType : document.type,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    })), React.createElement(TextDocument, {\n      className: \"txt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380\n      },\n      __self: this\n    }, document.name), document.languages && document.languages.length > 1 && React.createElement(Language, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, React.createElement(IconLang, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    })), !document.viewed && React.createElement(NewItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    })))))), React.createElement(\"div\", {\n      className: \"bottom-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      onClick: () => this.logout(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 396\n      },\n      __self: this\n    }, \"Logout\"), React.createElement(\"a\", {\n      className: staticValue === 'setting' ? 'active' : '',\n      href: \"/app-setting\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }, \"App Settings\"), React.createElement(\"a\", {\n      className: staticValue === 'term' ? 'active' : '',\n      href: \"/term-and-conditions\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398\n      },\n      __self: this\n    }, \"Term and conditions\"))));\n  }\n\n}\n\nSideMenu.propTypes = {\n  staticValue: propTypes.string\n};\nconst WrapperSideMenuPlayer = styled.div.withConfig({\n  displayName: \"SideMenu__WrapperSideMenuPlayer\",\n  componentId: \"sc-6rupqb-0\"\n})([\"background-color:\", \";position:absolute;height:100%;top:0;width:0;overflow:hidden;border-right:1px solid \", \";padding:0;box-sizing:border-box;opacity:1;z-index:10;\"], props => props.theme.colorContent, props => props.theme.colorBlue);\nconst WrapperSideMenu = styled.div.withConfig({\n  displayName: \"SideMenu__WrapperSideMenu\",\n  componentId: \"sc-6rupqb-1\"\n})([\"width:300px;flex:1 1 auto;background-color:\", \";position:relative;padding-top:60px;min-width:300px;box-sizing:border-box;border-right:1px solid \", \";display:flex;flex-direction:column;.content-menu{flex:1 1 100%;overflow-y:scroll;}.bottom-menu{flex:1 1 auto;display:flex;flex-direction:column;padding-left:20px;padding-bottom:15px;padding-top:10px;a{color:\", \" !important;font-size:\", \";padding:2px 0;&.active{font-size:17px;}}}.bottom-item{display:none;}\"], props => props.theme.colorBlue, props => props.theme.colorBlue, props => props.theme.colorWhite, props => props.theme.languagesSize);\nexport default SideMenu;","map":{"version":3,"sources":["/Users/mac/Documents/Intracon-3dapp-Website/app/src/components/Layout/SideMenu.js"],"names":["styled","React","Component","propTypes","ToggleContentParent","Menu","Image","Authorization","Document","removeAccessToken","RowItem","RowItemDocument","TextDocument","RowItemSub","TextSub","Icon","Text","NewItem","Language","IconLang","ContactIcon","FavoritesIcon","IconDocument","PopupChangeLanguage","SideMenu","rawMenus","openId","menus","layers","node","wrapperRef","value","animation","hashing","getCallBackChild","setState","layerIndex","state","menu","filter","id","parentMenuId","documents","documentList","isCalendar","name","toLowerCase","indexOf","hashes","location","hash","split","push","join","length","el","document","getElementById","getUrl","then","img","style","backgroundImage","data","display","splice","num","$","css","animate","promise","styleIndex","setDataState","stateLayers","docData","sort","a","b","position","theCalendar","index","isActive","lastIndex","layerLength","numId","toString","idLayer","x","width","delay","event","contains","target","elements","querySelectorAll","i","classList","remove","componentDidMount","addEventListener","handleClickOutside","response","getAll","forEach","item","viewed","show","replace","getCallBack","buildViewedDocument","componentWillUnmount","removeEventListener","map","flat","doc","finalMenu","menuId","closeAllLayer","logout","window","openCalendar","href","openDocument","viewedDocuments","openFavorites","favoriteDocuments","temp","result","includes","documentDTO","openContactPage","render","props","staticValue","setWrapperRef","primaryIconId","left","zIndex","backgroundColor","layer","e","documentType","type","languages","string","WrapperSideMenuPlayer","div","theme","colorContent","colorBlue","WrapperSideMenu","colorWhite","languagesSize"],"mappings":";;;;;;;AAAA;;AACA;AACA,OAAOA,MAAP,MAAmB,mBAAnB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,mBAAP,MAAgC,wBAAhC;AACA,OAAOC,IAAP,MAAiB,qBAAjB;AACA,OAAOC,KAAP,MAAkB,sBAAlB;AACA,OAAOC,aAAP,MAA0B,8BAA1B;AACA,OAAOC,QAAP,MAAqB,yBAArB;AACA,SAASC,iBAAT,QAAkC,qBAAlC;AACA,OAAOC,OAAP,MAAoB,4BAApB;AACA,OAAOC,eAAP,MAA4B,oCAA5B;AACA,OAAOC,YAAP,MAAyB,iCAAzB;AACA,OAAOC,UAAP,MAAuB,+BAAvB;AACA,OAAOC,OAAP,MAAoB,4BAApB;AACA,OAAOC,IAAP,MAAiB,yBAAjB;AACA,OAAOC,IAAP,MAAiB,yBAAjB;AACA,OAAOC,OAAP,MAAoB,4BAApB;AACA,OAAOC,QAAP,MAAqB,6BAArB;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,aAAhC,QAAqD,UAArD;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,OAAOC,mBAAP,MAAgC,wBAAhC;;AAEA,MAAMC,QAAN,SAAuBtB,SAAvB,CAAiC;AAAA;AAAA;;AAAA,mCACvB;AACNuB,MAAAA,QAAQ,EAAE,EADJ;AAENC,MAAAA,MAAM,EAAE,EAFF;AAGNC,MAAAA,KAAK,EAAE,EAHD;AAINC,MAAAA,MAAM,EAAE;AAJF,KADuB;;AAAA,2CA6CdC,IAAD,IAAU;AACxB,WAAKC,UAAL,GAAkBD,IAAlB;AACD,KA/C8B;;AAAA,yCAiDjB,OAAOE,KAAP,EAAcC,SAAd,EAAyBC,OAAzB,KAAqC;AACjD,YAAM,KAAKC,gBAAL,CAAsBH,KAAtB,EAA6B,CAA7B,EAAgCC,SAAhC,EAA2CC,OAA3C,CAAN;AACA,WAAKE,QAAL,CAAc;AAAET,QAAAA,MAAM,EAAEK;AAAV,OAAd;AACD,KApD8B;;AAAA,8CAsDZ,OAAOA,KAAP,EAAcK,UAAd,EAA0BJ,SAA1B,EAAqCC,OAArC,KAAiD;AAAA,0BACrC,KAAKI,KADgC;AAAA,YAC1DZ,QAD0D,eAC1DA,QAD0D;AAAA,YAChDG,MADgD,eAChDA,MADgD;AAElE,YAAMU,IAAI,GAAGb,QAAQ,CAACc,MAAT,CAAgBD,IAAI,IAAIA,IAAI,CAACE,EAAL,IAAWT,KAAnC,EAA0C,CAA1C,CAAb;AACA,YAAMJ,KAAK,GAAGF,QAAQ,CAACc,MAAT,CAAgBD,IAAI,IAAIA,IAAI,CAACG,YAAL,IAAqBV,KAA7C,CAAd;AACA,YAAMW,SAAS,GAAGJ,IAAI,CAACK,YAAvB;AACA,YAAMC,UAAU,GAAGN,IAAI,CAACO,IAAL,CAAUC,WAAV,GAAwBC,OAAxB,CAAgC,cAAhC,KAAmD,CAAC,CAApD,GAAwD,KAAxD,GAA+D,IAAlF,CALkE,CAOlE;;AACA,UAAI,CAACd,OAAL,EAAc;AACZ,cAAMe,MAAM,GAAGZ,UAAU,IAAI,CAAd,GAAkB,EAAlB,GAAuBa,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoB,GAApB,CAAtC;;AACA,YAAIH,MAAM,CAACZ,UAAD,CAAV,EAAwB;AACtBY,UAAAA,MAAM,CAACZ,UAAD,CAAN,GAAqBL,KAArB;AACD,SAFD,MAEO;AACLiB,UAAAA,MAAM,CAACI,IAAP,CAAYrB,KAAZ;AACD;;AACDkB,QAAAA,QAAQ,CAACC,IAAT,GAAgBF,MAAM,CAACK,IAAP,CAAY,GAAZ,CAAhB;AACD;;AAED,UAAI,CAACT,UAAD,IAAejB,KAAK,CAAC2B,MAAN,IAAgB,CAA/B,IAAoCZ,SAAS,CAACY,MAAV,IAAoB,CAA5D,EAA+D;AAC7D,YAAI1B,MAAM,CAAC0B,MAAP,GAAgB,CAAhB,IAAqB1B,MAAM,CAACQ,UAAU,GAAG,CAAd,CAA/B,EAAiD;AAC/CR,UAAAA,MAAM,CAACQ,UAAU,GAAG,CAAd,CAAN,CAAuBV,MAAvB,GAAgCK,KAAhC;AACD;;AAED,YAAIK,UAAU,IAAI,CAAlB,EAAqB;AACnB,gBAAMmB,EAAE,GAAGC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAX;AACAnD,UAAAA,KAAK,CAACoD,MAAN,CAAa3B,KAAb,EAAoB4B,IAApB,CAAyBC,GAAG,IAAI;AAC9BL,YAAAA,EAAE,CAACM,KAAH,CAASC,eAAT,GAA4B,QAAOF,GAAG,CAACG,IAAK,IAA5C;AACAR,YAAAA,EAAE,CAACM,KAAH,CAASG,OAAT,GAAmB,OAAnB;AACD,WAHD;AAID;;AAEDpC,QAAAA,MAAM,CAACqC,MAAP,CAAc7B,UAAd;AACA,aAAKD,QAAL,CAAc;AAAEP,UAAAA;AAAF,SAAd;AACD,OAfD,MAeO;AACL,cAAMsC,GAAG,GAAG9B,UAAU,GAAG,CAAzB;;AACA,YAAIA,UAAU,GAAG,CAAjB,EAAoB;AAClB,cAAIJ,SAAS,IAAIkC,GAAG,GAAG,CAAN,IAAWtC,MAAM,CAAC0B,MAAnC,EAA4C;AAC1Ca,YAAAA,CAAC,CAAE,SAAQD,GAAI,EAAd,CAAD,CAAkBE,GAAlB,CAAsB;AAAE,yBAAW;AAAb,aAAtB;AACA,kBAAMD,CAAC,CAAE,SAAQD,GAAI,EAAd,CAAD,CAAkBG,OAAlB,CAA0B;AAAE,sBAAQ;AAAV,aAA1B,EAAiDC,OAAjD,EAAN;;AACA,gBAAI1C,MAAM,CAACsC,GAAD,CAAV,EAAiB;AACftC,cAAAA,MAAM,CAACsC,GAAD,CAAN,CAAYK,UAAZ,GAAyB,CAAzB;AACD;AACF;;AACD,eAAKC,YAAL,CAAkB5C,MAAlB,EAA0BG,KAA1B,EAAiCK,UAAjC,EAA6CJ,SAA7C;AACD,SATD,MASO;AACL,eAAKwC,YAAL,CAAkB5C,MAAlB,EAA0BG,KAA1B,EAAiCK,UAAjC,EAA6CJ,SAA7C;AACD;AACF;AACF,KAtG8B;;AAAA,0CAwGhB,CAACyC,WAAD,EAAc1C,KAAd,EAAqBK,UAArB,EAAiCJ,SAAjC,KAA+C;AAAA,YACpDP,QADoD,GACvC,KAAKY,KADkC,CACpDZ,QADoD;AAE5D,YAAMG,MAAM,GAAG,CAAC,GAAG6C,WAAJ,CAAf;AACA,YAAMnC,IAAI,GAAGb,QAAQ,CAACc,MAAT,CAAgBD,IAAI,IAAIA,IAAI,CAACE,EAAL,IAAWT,KAAnC,EAA0C,CAA1C,CAAb;AACA,YAAMJ,KAAK,GAAGF,QAAQ,CAACc,MAAT,CAAgBD,IAAI,IAAIA,IAAI,CAACG,YAAL,IAAqBV,KAA7C,CAAd;AACA,YAAMW,SAAS,GAAGJ,IAAI,CAACK,YAAvB;;AAEA,UAAIP,UAAU,IAAI,CAAlB,EAAqB;AACnB;AACA,cAAMmB,EAAE,GAAGC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAAX,CAFmB,CAInB;;AACAnD,QAAAA,KAAK,CAACoD,MAAN,CAAa3B,KAAb,EAAoB4B,IAApB,CAAyBC,GAAG,IAAI;AAC9BL,UAAAA,EAAE,CAACM,KAAH,CAASC,eAAT,GAA4B,QAAOF,GAAG,CAACG,IAAK,IAA5C;AACAR,UAAAA,EAAE,CAACM,KAAH,CAASG,OAAT,GAAmB,OAAnB;AACD,SAHD;AAID;;AAEDpC,MAAAA,MAAM,CAACqC,MAAP,CAAc7B,UAAd,EAlB4D,CAoB5D;;AACA,YAAMsC,OAAO,GAAGhC,SAAS,CAACiC,IAAV,CAAe,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAACE,QAAF,GAAaD,CAAC,CAACC,QAAxC,CAAhB;AACA,YAAMC,WAAW,GAAGzC,IAAI,CAACO,IAAL,CAAUC,WAAV,GAAwBC,OAAxB,CAAgC,cAAhC,KAAmD,CAAC,CAApD,GAAwD,KAAxD,GAA+D,IAAnF;AAEAnB,MAAAA,MAAM,CAACwB,IAAP,CAAY;AACVZ,QAAAA,EAAE,EAAG,QAAOJ,UAAW,EADb;AAEV4C,QAAAA,KAAK,EAAE5C,UAFG;AAGVmC,QAAAA,UAAU,EAAEnC,UAAU,GAAG,CAAb,GAAiB,CAAjB,GAAqBA,UAHvB;AAIVK,QAAAA,YAAY,EAAEV,KAJJ;AAKVJ,QAAAA,KAAK,EAAEA,KALG;AAMVe,QAAAA,SAAS,EAAEgC,OAND;AAOV9B,QAAAA,UAAU,EAAEmC,WAPF;AAQVE,QAAAA,QAAQ,EAAE;AARA,OAAZ;AAWA,YAAMC,SAAS,GAAG9C,UAAU,IAAI,CAAd,GAAkBA,UAAlB,GAA+BA,UAAU,GAAG,CAA9D;AACAR,MAAAA,MAAM,CAACsD,SAAD,CAAN,CAAkBxD,MAAlB,GAA2BK,KAA3B;AAEA,UAAIoD,WAAW,GAAGvD,MAAM,CAAC0B,MAAzB;AACA,WAAKnB,QAAL,CAAc;AAAEP,QAAAA;AAAF,OAAd,EAA0B,MAAM;AAE9B;AACA,YAAIwD,KAAK,GAAIhD,UAAD,CAAaiD,QAAb,EAAZ;AACA,YAAIC,OAAO,GAAG,WAAWF,KAAzB;;AAEA,aAAK,IAAIG,CAAC,GAAGnD,UAAb,EAAyBmD,CAAC,GAAGJ,WAA7B,EAAyCI,CAAC,EAA1C,EAA8C;AAC5CpB,UAAAA,CAAC,CAAE,yBAAwBoB,CAAE,EAA5B,CAAD,CAAgCnB,GAAhC,CAAoC;AAAEJ,YAAAA,OAAO,EAAE,MAAX;AAAmBwB,YAAAA,KAAK,EAAE;AAA1B,WAApC;AACD;;AAED,YAAIxD,SAAJ,EAAe;AACbmC,UAAAA,CAAC,CAAE,mBAAkBmB,OAAQ,EAA5B,CAAD,CAAgCG,KAAhC,CAAsC,GAAtC,EAA2CrB,GAA3C,CAA+C;AAAEJ,YAAAA,OAAO,EAAE;AAAX,WAA/C,EAAqEK,OAArE,CAA6E;AAAEmB,YAAAA,KAAK,EAAE;AAAT,WAA7E;AACD,SAFD,MAEO;AACLrB,UAAAA,CAAC,CAAE,mBAAkBmB,OAAQ,EAA5B,CAAD,CAAgClB,GAAhC,CAAoC;AAAEJ,YAAAA,OAAO,EAAE,OAAX;AAAoBwB,YAAAA,KAAK,EAAE;AAA3B,WAApC;AACD;AACF,OAfD;AAgBD,KA/J8B;;AAAA,gDAiKVE,KAAK,IAAI;AAC5B,UAAI,KAAK5D,UAAL,IAAmB,CAAC,KAAKA,UAAL,CAAgB6D,QAAhB,CAAyBD,KAAK,CAACE,MAA/B,CAAxB,EAAgE;AAC9D,YAAIC,QAAQ,GAAGrC,QAAQ,CAACsC,gBAAT,CAA0B,iBAA1B,CAAf;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAACvC,MAA7B,EAAqCyC,CAAC,EAAtC,EAA0C;AACxCF,UAAAA,QAAQ,CAACE,CAAD,CAAR,CAAYC,SAAZ,CAAsBC,MAAtB,CAA6B,MAA7B;AACD;AACF;AACF,KAxK8B;AAAA;;AAQ/B,QAAMC,iBAAN,GAA0B;AACxB1C,IAAAA,QAAQ,CAAC2C,gBAAT,CAA0B,WAA1B,EAAuC,KAAKC,kBAA5C;AACA,UAAMzE,KAAK,GAAG,EAAd;AACA,UAAM0E,QAAQ,GAAG,MAAMhG,IAAI,CAACiG,MAAL,EAAvB;AACAD,IAAAA,QAAQ,CAACtC,IAAT,CAAcY,IAAd,CAAmB,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAACE,QAAF,GAAaD,CAAC,CAACC,QAA5C;AACAuB,IAAAA,QAAQ,CAACtC,IAAT,CAAcwC,OAAd,CAAsBC,IAAI,IAAI;AAC5BA,MAAAA,IAAI,CAACC,MAAL,GAAc,IAAd;;AACA,UAAI,CAACD,IAAI,CAAC/D,YAAV,EAAwB;AACtBd,QAAAA,KAAK,CAACyB,IAAN,CAAWoD,IAAX;AACD;AACF,KALD;AAOA,SAAKrE,QAAL,CAAc;AAAER,MAAAA,KAAF;AAASF,MAAAA,QAAQ,EAAE4E,QAAQ,CAACtC;AAA5B,KAAd,EAAkD,YAAY;AAC5DI,MAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBuC,IAAlB,GAAyBtC,GAAzB,CAA6B,SAA7B,EAAuC,MAAvC,EAD4D,CAG5D;;AACA,YAAMpB,MAAM,GAAGC,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoB,GAApB,CAAf;;AACA,WAAK,IAAIoC,CAAC,GAAG,CAAb,EAAeA,CAAC,GAAGvC,MAAM,CAACM,MAA1B,EAAiCiC,CAAC,EAAlC,EAAsC;AACpCvC,QAAAA,MAAM,CAACuC,CAAD,CAAN,GAAYvC,MAAM,CAACuC,CAAD,CAAN,CAAUoB,OAAV,CAAkB,GAAlB,EAAuB,EAAvB,CAAZ;;AACA,YAAI3D,MAAM,CAACuC,CAAD,CAAV,EAAe;AACb,cAAIA,CAAC,IAAI,CAAT,EAAY;AACV,kBAAM,KAAKqB,WAAL,CAAiB5D,MAAM,CAACuC,CAAD,CAAvB,EAA4B,KAA5B,EAAmC,IAAnC,CAAN;AACD,WAFD,MAEO;AACL,kBAAM,KAAKrD,gBAAL,CAAsBc,MAAM,CAACuC,CAAD,CAA5B,EAAiCA,CAAjC,EAAoC,KAApC,EAA2C,IAA3C,CAAN;AACD;AACF;AACF,OAd2D,CAgB5D;;;AACA,WAAKsB,mBAAL;AACD,KAlBD;AAmBD;;AAEDC,EAAAA,oBAAoB,GAAG;AACrBtD,IAAAA,QAAQ,CAACuD,mBAAT,CAA6B,WAA7B,EAA0C,KAAKX,kBAA/C;AACD;;AA+HDS,EAAAA,mBAAmB,GAAG;AAAA,UACZpF,QADY,GACC,KAAKY,KADN,CACZZ,QADY;AAEpB,UAAMiB,SAAS,GAAGjB,QAAQ,CAACuF,GAAT,CAAa1E,IAAI,IAAIA,IAAI,CAACK,YAA1B,EAAwCsE,IAAxC,EAAlB;AACAvE,IAAAA,SAAS,CAAC6D,OAAV,CAAkBW,GAAG,IAAI;AACvB,UAAI,CAACA,GAAG,CAACT,MAAT,EAAiB;AACf,YAAIU,SAAS,GAAGD,GAAG,CAACE,MAApB,CADe,CAEf;;AACA,eAAOD,SAAP,EAAkB;AAChB1F,UAAAA,QAAQ,CAAC8E,OAAT,CAAiBjE,IAAI,IAAI;AACvB,gBAAIA,IAAI,CAACE,EAAL,IAAW2E,SAAf,EAA0B;AACxB7E,cAAAA,IAAI,CAACmE,MAAL,GAAc,KAAd;AACAU,cAAAA,SAAS,GAAG7E,IAAI,CAACG,YAAjB;AACD;AACF,WALD;AAMD;AACF;AACF,KAbD;AAeA,SAAKN,QAAL,CAAc;AAAEV,MAAAA;AAAF,KAAd;AACD;;AAED4F,EAAAA,aAAa,GAAG;AACd,QAAIxB,QAAQ,GAAGrC,QAAQ,CAACsC,gBAAT,CAA0B,iBAA1B,CAAf;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAACvC,MAA7B,EAAqCyC,CAAC,EAAtC,EAA0C;AACxCF,MAAAA,QAAQ,CAACE,CAAD,CAAR,CAAYC,SAAZ,CAAsBC,MAAtB,CAA6B,MAA7B;AACD;AACF;;AAEDqB,EAAAA,MAAM,GAAG;AACP/G,IAAAA,aAAa,CAAC+G,MAAd,CAAqB,KAArB,EAA4B3D,IAA5B,CAAiC0C,QAAQ,IAAI;AAC3C5F,MAAAA,iBAAiB;;AACjB,UAAI4F,QAAQ,CAACtC,IAAT,IAAiB,IAArB,EAA2B;AACzBwD,QAAAA,MAAM,CAACtE,QAAP,GAAkBoD,QAAQ,CAACtC,IAA3B;AACD,OAFD,MAEO;AACLwD,QAAAA,MAAM,CAACtE,QAAP,GAAkB,GAAlB;AACD;AACF,KAPD;AAQD;;AAEDuE,EAAAA,YAAY,GAAG;AACbD,IAAAA,MAAM,CAACtE,QAAP,CAAgBwE,IAAhB,GAAuB,WAAvB;AACD;;AAEDC,EAAAA,YAAY,CAACpF,IAAD,EAAOkB,QAAP,EAAiB;AAC3BhD,IAAAA,QAAQ,CAACmH,eAAT,CAAyBnE,QAAzB,EAAmCG,IAAnC,CAAwC,MAAM;AAC5C4D,MAAAA,MAAM,CAACtE,QAAP,CAAgBwE,IAAhB,GAAwB,0BAAyBnF,IAAK,aAAYkB,QAAS,EAA3E;AACD,KAFD;AAGD;;AAED,QAAMoE,aAAN,GAAsB;AAAA,yBACS,KAAKvF,KADd;AAAA,UACZT,MADY,gBACZA,MADY;AAAA,UACJH,QADI,gBACJA,QADI;AAEpB,UAAMiB,SAAS,GAAG,MAAMlC,QAAQ,CAACqH,iBAAT,EAAxB;AACA,UAAMC,IAAI,GAAGrG,QAAQ,CAACuF,GAAT,CAAa1E,IAAI,IAAIA,IAAI,CAACK,YAAL,CAAkBqE,GAAlB,CAAsBR,IAAI,IAAIA,IAAI,CAAChE,EAAnC,CAArB,EAA6DyE,IAA7D,EAAb;AACA,UAAMc,MAAM,GAAG,EAAf;;AACA,QAAID,IAAJ,EAAU;AACRpF,MAAAA,SAAS,CAACqB,IAAV,CAAewC,OAAf,CAAuBC,IAAI,IAAI;AAC7B,YAAIsB,IAAI,CAACE,QAAL,CAAcxB,IAAI,CAACyB,WAAL,CAAiBzF,EAA/B,CAAJ,EAAwC;AACtCuF,UAAAA,MAAM,CAAC3E,IAAP,CAAYoD,IAAI,CAACyB,WAAjB;AACD;AACF,OAJD;AAKD;;AACDrG,IAAAA,MAAM,CAACqC,MAAP,CAAc,CAAd;AACArC,IAAAA,MAAM,CAACwB,IAAP,CAAY;AACVZ,MAAAA,EAAE,EAAE,QADM;AAEVwC,MAAAA,KAAK,EAAE,CAFG;AAGVT,MAAAA,UAAU,EAAE,CAHF;AAIV9B,MAAAA,YAAY,EAAE,UAJJ;AAKVd,MAAAA,KAAK,EAAE,EALG;AAMVe,MAAAA,SAAS,EAAEqF,MAND;AAOV9C,MAAAA,QAAQ,EAAE;AAPA,KAAZ;AAUA,SAAK9C,QAAL,CAAc;AAAET,MAAAA,MAAM,EAAE,KAAV;AAAiBE,MAAAA;AAAjB,KAAd,EAAyC,MAAM;AAC7C;AACA,UAAI0D,OAAO,GAAG,SAAd;AACAnB,MAAAA,CAAC,CAAE,mBAAkBmB,OAAQ,EAA5B,CAAD,CAAgClB,GAAhC,CAAoC;AAAEJ,QAAAA,OAAO,EAAE,MAAX;AAAmBwB,QAAAA,KAAK,EAAE;AAA1B,OAApC;AACArB,MAAAA,CAAC,CAAE,mBAAkBmB,OAAQ,EAA5B,CAAD,CAAgCG,KAAhC,CAAsC,GAAtC,EAA2CrB,GAA3C,CAA+C;AAAEJ,QAAAA,OAAO,EAAE;AAAX,OAA/C,EAAqEK,OAArE,CAA6E;AAAEmB,QAAAA,KAAK,EAAE;AAAT,OAA7E;AACD,KALD;AAMD;;AAED0C,EAAAA,eAAe,GAAG;AAChBX,IAAAA,MAAM,CAACtE,QAAP,CAAgBwE,IAAhB,GAAuB,UAAvB;AACD;;AAEDU,EAAAA,MAAM,CAACC,KAAD,EAAQ;AAAA,UACJC,WADI,GACY,KAAKD,KADjB,CACJC,WADI;AAAA,yBAEsB,KAAKhG,KAF3B;AAAA,UAEJX,MAFI,gBAEJA,MAFI;AAAA,UAEIC,KAFJ,gBAEIA,KAFJ;AAAA,UAEWC,MAFX,gBAEWA,MAFX;AAGZ,WACE,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,eAAD;AAAiB,MAAA,EAAE,EAAC,gBAApB;AAAqC,MAAA,GAAG,EAAE,KAAK0G,aAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI3G,KAAK,CAACqF,GAAN,CAAUR,IAAI,IACZ,oBAAC,mBAAD;AACE,MAAA,GAAG,EAAEA,IAAI,CAAChE,EADZ;AAEE,MAAA,OAAO,EAAEgE,IAAI,CAAC+B,aAFhB;AAGE,MAAA,KAAK,EAAE/B,IAAI,CAAC3D,IAHd;AAIE,MAAA,EAAE,EAAE2D,IAAI,CAAChE,EAJX;AAKE,MAAA,KAAK,EAAEd,MALT;AAME,MAAA,OAAO,EAAE,KAAKkF,WANhB;AAOE,MAAA,MAAM,EAAEJ,IAAI,CAACC,MAPf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFJ,EAeE,oBAAC,OAAD;AACE,MAAA,SAAS,EAAE/E,MAAM,IAAI,KAAV,GAAkB,6BAAlB,GAAkD,sBAD/D;AAEE,MAAA,OAAO,EAAE,MAAM,KAAKkG,aAAL,EAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA4B,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA5B,CAJF,EAKE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBALF,CAfF,EAsBE,oBAAC,OAAD;AACE,MAAA,SAAS,EAAES,WAAW,KAAK,SAAhB,GAA4B,6BAA5B,GAA4D,sBADzE;AAEE,MAAA,OAAO,EAAE,MAAM,KAAKH,eAAL,EAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA4B,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA5B,CAJF,EAKE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBALF,CAtBF,EA8BE,oBAAC,qBAAD;AACM,MAAA,GAAG,EAAE,GADX;AAEM,MAAA,EAAE,EAAE,QAFV;AAGM,MAAA,KAAK,EAAE;AAAEM,QAAAA,IAAI,EAAG,MAAT;AAAgBC,QAAAA,MAAM,EAAE;AAAxB,OAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKO,oBAAC,eAAD;AAAiB,MAAA,KAAK,EAAI;AAACC,QAAAA,eAAe,EAAE;AAAlB,OAA1B;AACK,MAAA,IAAI,EAAC,QADV;AAEK,MAAA,SAAS,EAAE,UAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIK,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,YAAD;AAAc,MAAA,YAAY,EAAE,KAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAJL,EAOK,oBAAC,YAAD;AAAc,MAAA,SAAS,EAAC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAPL,EAQO,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CARP,EAYI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZJ,EAaI,oBAAC,mBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbJ,CALP,CA9BF,EAsDI9G,MAAM,IAAIA,MAAM,CAACoF,GAAP,CAAW2B,KAAK,IACxB,oBAAC,qBAAD;AACE,MAAA,GAAG,EAAEA,KAAK,CAACnG,EADb;AAEE,MAAA,EAAE,EAAE,UAAUmG,KAAK,CAAC3D,KAFtB;AAGE,MAAA,KAAK,EAAE;AAAEwD,QAAAA,IAAI,EAAG,GAAE,CAACG,KAAK,CAACpE,UAAN,GAAmB,CAApB,IAAyB,GAAI,GAAxC;AAA4CkE,QAAAA,MAAM,EAAE,OAAOE,KAAK,CAACpE;AAAjE,OAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAMIoE,KAAK,CAAC/F,UAAN,IACA,oBAAC,UAAD;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,SAAS,EAAEyF,WAAW,KAAK,UAAhB,GAA6B,iBAA7B,GAAiD,UAF9D;AAGE,MAAA,GAAG,EAAC,UAHN;AAIE,MAAA,OAAO,EAAEO,CAAC,IAAI,KAAKpB,YAAL,EAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCANF,CAPJ,EAiBImB,KAAK,CAAChH,KAAN,IAAegH,KAAK,CAAChH,KAAN,CAAYqF,GAAZ,CAAgB1E,IAAI,IACjC,oBAAC,UAAD;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,SAAS,EAAEqG,KAAK,CAACjH,MAAN,IAAgBY,IAAI,CAACE,EAArB,GAA0B,iBAA1B,GAA8C,UAF3D;AAGE,MAAA,GAAG,EAAEF,IAAI,CAACE,EAHZ;AAIE,MAAA,OAAO,EAAEoG,CAAC,IAAI,KAAK1G,gBAAL,CAAsBI,IAAI,CAACE,EAA3B,EAA+BmG,KAAK,CAAC3D,KAAN,GAAc,CAA7C,EAAgD,IAAhD,CAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA0B1C,IAAI,CAACO,IAA/B,CANF,EAOI,CAACP,IAAI,CAACmE,MAAN,IAAgB,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPpB,CADa,CAjBnB,EA8BIkC,KAAK,CAACjG,SAAN,IAAmBiG,KAAK,CAACjG,SAAN,CAAgBsE,GAAhB,CAAoBxD,QAAQ,IAC7C,oBAAC,eAAD;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,SAAS,EAAEmF,KAAK,CAACjH,MAAN,IAAgB8B,QAAQ,CAAChB,EAAzB,GAA8B,iBAA9B,GAAkD,UAF/D;AAGE,MAAA,GAAG,EAAEgB,QAAQ,CAAChB,EAHhB;AAIE,MAAA,OAAO,EAAEoG,CAAC,IAAI,KAAKlB,YAAL,CAAkBiB,KAAK,CAAClG,YAAxB,EAAsCe,QAAQ,CAAChB,EAA/C,CAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,YAAD;AAAc,MAAA,YAAY,EAAEgB,QAAQ,CAACqF,YAAT,GAAwBrF,QAAQ,CAACqF,YAAjC,GAAgDrF,QAAQ,CAACsF,IAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CANF,EASE,oBAAC,YAAD;AAAc,MAAA,SAAS,EAAC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+BtF,QAAQ,CAACX,IAAxC,CATF,EAWIW,QAAQ,CAACuF,SAAT,IAAsBvF,QAAQ,CAACuF,SAAT,CAAmBzF,MAAnB,GAA4B,CAAlD,IACA,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAZJ,EAgBI,CAACE,QAAQ,CAACiD,MAAV,IAAoB,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAhBxB,CADiB,CA9BvB,CADQ,CAtDd,CADF,EA+GE;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAG,MAAA,IAAI,EAAC,GAAR;AAAY,MAAA,OAAO,EAAE,MAAM,KAAKa,MAAL,EAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAEE;AAAG,MAAA,SAAS,EAAEe,WAAW,KAAK,SAAhB,GAA4B,QAA5B,GAAuC,EAArD;AAAyD,MAAA,IAAI,EAAC,cAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF,EAGE;AAAG,MAAA,SAAS,EAAEA,WAAW,KAAK,MAAhB,GAAyB,QAAzB,GAAoC,EAAlD;AAAsD,MAAA,IAAI,EAAC,sBAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAHF,CA/GF,CADF,CADF;AAyHD;;AA1X8B;;AA6XjC7G,QAAQ,CAACrB,SAAT,GAAqB;AACnBkI,EAAAA,WAAW,EAAElI,SAAS,CAAC6I;AADJ,CAArB;AAIA,MAAMC,qBAAqB,GAAGjJ,MAAM,CAACkJ,GAAV;AAAA;AAAA;AAAA,4KACLd,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYC,YADhB,EAOChB,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYE,SAPtB,CAA3B;AAcA,MAAMC,eAAe,GAAGtJ,MAAM,CAACkJ,GAAV;AAAA;AAAA;AAAA,gdAGCd,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYE,SAHtB,EAQOjB,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYE,SAR5B,EA0BNjB,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYI,UA1Bf,EA2BFnB,KAAK,IAAIA,KAAK,CAACe,KAAN,CAAYK,aA3BnB,CAArB;AAyCA,eAAehI,QAAf","sourcesContent":["/* eslint-disable no-loops/no-loops */\n/* eslint-disable no-undef */\nimport styled from 'styled-components'\nimport React, { Component } from 'react'\nimport propTypes from 'prop-types'\nimport ToggleContentParent from '../ToggleContentParent'\nimport Menu from '../../services/menu'\nimport Image from '../../services/image'\nimport Authorization from '../../services/authorization'\nimport Document from '../../services/document'\nimport { removeAccessToken } from '../../utils/storage'\nimport RowItem from '../UI/ItemSideMenu/RowItem'\nimport RowItemDocument from '../UI/ItemSideMenu/RowItemDocument'\nimport TextDocument from '../UI/ItemSideMenu/TextDocument'\nimport RowItemSub from '../UI/ItemSideMenu/RowItemSub'\nimport TextSub from '../UI/ItemSideMenu/TextSub'\nimport Icon from '../UI/ItemSideMenu/Icon'\nimport Text from '../UI/ItemSideMenu/Text'\nimport NewItem from '../UI/ItemSideMenu/NewItem'\nimport Language from '../UI/ItemSideMenu/Language'\nimport { IconLang, ContactIcon, FavoritesIcon } from '../Icons'\nimport IconDocument from '../IconDocument'\nimport PopupChangeLanguage from '../PopupChangeLanguage';\n\nclass SideMenu extends Component {\n  state = {\n    rawMenus: '',\n    openId: '',\n    menus: [],\n    layers: []\n  }\n\n  async componentDidMount() {\n    document.addEventListener('mousedown', this.handleClickOutside)\n    const menus = []\n    const response = await Menu.getAll()\n    response.data.sort((a, b) => a.position - b.position)\n    response.data.forEach(item => {\n      item.viewed = true\n      if (!item.parentMenuId) {\n        menus.push(item)\n      }\n    })\n\n    this.setState({ menus, rawMenus: response.data }, async () => {\n      $('.bottom-item').show().css('display','flex')\n\n      // parse the hashes and restore menu states\n      const hashes = location.hash.split('/')\n      for (let x = 0;x < hashes.length;x++) {\n        hashes[x] = hashes[x].replace('#', '')\n        if (hashes[x]) {\n          if (x == 0) {\n            await this.getCallBack(hashes[x], false, true)\n          } else {\n            await this.getCallBackChild(hashes[x], x, false, true)\n          }\n        }\n      }\n\n      // build viewed data\n      this.buildViewedDocument()\n    })\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleClickOutside)\n  }\n\n  setWrapperRef = (node) => {\n    this.wrapperRef = node\n  }\n\n  getCallBack = async (value, animation, hashing) => {\n    await this.getCallBackChild(value, 0, animation, hashing)\n    this.setState({ openId: value })\n  }\n\n  getCallBackChild = async (value, layerIndex, animation, hashing) => {\n    const { rawMenus, layers } = this.state\n    const menu = rawMenus.filter(menu => menu.id == value)[0]\n    const menus = rawMenus.filter(menu => menu.parentMenuId == value)\n    const documents = menu.documentList\n    const isCalendar = menu.name.toLowerCase().indexOf('3dp training') == -1 ? false: true\n\n    // change hash location so it can perform go back function\n    if (!hashing) {\n      const hashes = layerIndex == 0 ? [] : location.hash.split('/')\n      if (hashes[layerIndex]) {\n        hashes[layerIndex] = value\n      } else {\n        hashes.push(value)\n      }\n      location.hash = hashes.join('/')\n    }\n\n    if (!isCalendar && menus.length == 0 && documents.length == 0) {\n      if (layers.length > 0 && layers[layerIndex - 1]) {\n        layers[layerIndex - 1].openId = value\n      }\n\n      if (layerIndex == 0) {\n        const el = document.getElementById('bgMainPage')\n        Image.getUrl(value).then(img => {\n          el.style.backgroundImage = `url('${img.data}')`\n          el.style.display = 'block'\n        })\n      }\n      \n      layers.splice(layerIndex)\n      this.setState({ layers })\n    } else {\n      const num = layerIndex - 1\n      if (layerIndex > 2) {\n        if (animation && num + 1 == layers.length ) {\n          $(`#layer${num}`).css({ 'z-index': 1100 })\n          await $(`#layer${num}`).animate({ 'left': '-=200px' }).promise()\n          if (layers[num]) {\n            layers[num].styleIndex = 1\n          }\n        }\n        this.setDataState(layers, value, layerIndex, animation)\n      } else {\n        this.setDataState(layers, value, layerIndex, animation)\n      }\n    }\n  }\n\n  setDataState = (stateLayers, value, layerIndex, animation) => {\n    const { rawMenus } = this.state\n    const layers = [...stateLayers]\n    const menu = rawMenus.filter(menu => menu.id == value)[0]\n    const menus = rawMenus.filter(menu => menu.parentMenuId == value)\n    const documents = menu.documentList\n\n    if (layerIndex == 0) {\n      // click on non main page (contact, setting, calendar pages)\n      const el = document.getElementById('bgMainPage')\n\n      // change background if it is on main page\n      Image.getUrl(value).then(img => {\n        el.style.backgroundImage = `url('${img.data}')`\n        el.style.display = 'block'\n      })\n    }\n\n    layers.splice(layerIndex)\n    \n    // sort menus by position\n    const docData = documents.sort((a, b) => a.position - b.position)\n    const theCalendar = menu.name.toLowerCase().indexOf('3dp training') == -1 ? false: true\n\n    layers.push({\n      id: `layer${layerIndex}`,\n      index: layerIndex,\n      styleIndex: layerIndex > 2 ? 2 : layerIndex,\n      parentMenuId: value,\n      menus: menus,\n      documents: docData,\n      isCalendar: theCalendar,\n      isActive: true\n    })\n\n    const lastIndex = layerIndex == 0 ? layerIndex : layerIndex - 1\n    layers[lastIndex].openId = value\n\n    let layerLength = layers.length\n    this.setState({ layers }, () => {\n\n      // perform slide in / slide out effect\n      let numId = (layerIndex).toString()\n      let idLayer = '#layer' + numId\n\n      for (let x = layerIndex; x < layerLength;x++) {\n        $(`#side-menu-user #layer${x}`).css({ display: 'none', width: 0 })\n      }\n\n      if (animation) {\n        $(`#side-menu-user ${idLayer}`).delay(300).css({ display: 'block' }).animate({ width: 300 })\n      } else {\n        $(`#side-menu-user ${idLayer}`).css({ display: 'block', width: 300 })\n      }\n    })\n  }\n\n  handleClickOutside = event => {\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target)) {\n      var elements = document.querySelectorAll('.sub-menu-child')\n      for (let i = 0; i < elements.length; i++) {\n        elements[i].classList.remove('open')\n      }\n    }\n  }\n\n  buildViewedDocument() {\n    const { rawMenus } = this.state\n    const documents = rawMenus.map(menu => menu.documentList).flat()\n    documents.forEach(doc => {\n      if (!doc.viewed) {\n        let finalMenu = doc.menuId\n        // set new icon to the parent\n        while (finalMenu) {\n          rawMenus.forEach(menu => {\n            if (menu.id == finalMenu) {\n              menu.viewed = false\n              finalMenu = menu.parentMenuId\n            }\n          })\n        }\n      }\n    })\n\n    this.setState({ rawMenus })\n  }\n\n  closeAllLayer() {\n    var elements = document.querySelectorAll('.sub-menu-child')\n    for (let i = 1; i < elements.length; i++) {\n      elements[i].classList.remove('open')\n    }\n  }\n\n  logout() {\n    Authorization.logout('web').then(response => {\n      removeAccessToken()\n      if (response.data != 'OK') {\n        window.location = response.data\n      } else {\n        window.location = '/'\n      }\n    })\n  }\n\n  openCalendar() {\n    window.location.href = '/calendar'\n  }\n\n  openDocument(menu, document) {\n    Document.viewedDocuments(document).then(() => {\n      window.location.href = `/content-viewer?menuId=${menu}&document=${document}`\n    })\n  }\n\n  async openFavorites() {\n    const { layers, rawMenus } = this.state\n    const documents = await Document.favoriteDocuments()\n    const temp = rawMenus.map(menu => menu.documentList.map(item => item.id)).flat()\n    const result = []\n    if (temp) {\n      documents.data.forEach(item => {\n        if (temp.includes(item.documentDTO.id)) {\n          result.push(item.documentDTO)\n        }\n      })\n    }\n    layers.splice(0)\n    layers.push({\n      id: 'layer0',\n      index: 0,\n      styleIndex: 0,\n      parentMenuId: 'favorite',\n      menus: [],\n      documents: result,\n      isActive: true\n    })\n\n    this.setState({ openId: 'fav', layers }, () => {\n      // perform slide in / slide out effect for favorite page\n      let idLayer = '#layer0'\n      $(`#side-menu-user ${idLayer}`).css({ display: 'none', width: 0 })\n      $(`#side-menu-user ${idLayer}`).delay(300).css({ display: 'block' }).animate({ width: 300 })\n    })\n  }\n\n  openContactPage() {\n    window.location.href = '/contact'\n  }\n\n  render(props) {\n    const { staticValue } = this.props\n    const { openId, menus, layers } = this.state\n    return (\n      <React.Fragment>\n        <WrapperSideMenu id='side-menu-user' ref={this.setWrapperRef}>\n          <div className='content-menu'>\n            {\n              menus.map(item => (\n                <ToggleContentParent\n                  key={item.id}\n                  imageId={item.primaryIconId}\n                  title={item.name}\n                  id={item.id}\n                  keyId={openId} \n                  getData={this.getCallBack}\n                  viewed={item.viewed}\n                />\n              ))\n            }\n           \n            <RowItem\n              className={openId == 'fav' ? 'active row-item bottom-item' : 'row-item bottom-item'}\n              onClick={() => this.openFavorites()}\n            >\n              <Icon className='icon-menu'><FavoritesIcon /></Icon>\n              <Text className='txt'>Favorites</Text>\n            </RowItem>\n            <RowItem\n              className={staticValue === 'contact' ? 'active row-item bottom-item' : 'row-item bottom-item'}\n              onClick={() => this.openContactPage()}\n            >\n              <Icon className='icon-menu'><ContactIcon /></Icon>\n              <Text className='txt'>Contact</Text>\n            </RowItem>\n\n            <WrapperSideMenuPlayer\n                  key={'1'}\n                  id={'layer1'}\n                  style={{ left: `100%`, zIndex: 1000}}\n                >\n                   <RowItemDocument style= { {backgroundColor: '#fff'}}\n                        role='button'\n                        className={'row-item'}\n                      >\n                        <Icon className='icon-menu'>\n                          <IconDocument documentType={'pdf'} />\n                        </Icon>\n                        <TextDocument className='txt'>1234 fsf </TextDocument>\n                          <Language>\n                            <IconLang />\n                          </Language>\n\n                       <NewItem /> \n                       <PopupChangeLanguage></PopupChangeLanguage>\n              </RowItemDocument>\n                      \n                </WrapperSideMenuPlayer>\n\n            {\n              layers && layers.map(layer => (\n                <WrapperSideMenuPlayer\n                  key={layer.id}\n                  id={'layer' + layer.index}\n                  style={{ left: `${(layer.styleIndex + 1) * 100}%`, zIndex: 1000 - layer.styleIndex }}\n                >\n                  {\n                    layer.isCalendar && (\n                    <RowItemSub\n                      role='button'\n                      className={staticValue === 'calendar' ? 'active row-item' : 'row-item'}\n                      key='calendar'\n                      onClick={e => this.openCalendar()}\n                    >\n                      <TextSub className='txt'>WW 3DP Training Calendar</TextSub>\n                    </RowItemSub>\n)}\n                  {\n                    layer.menus && layer.menus.map(menu => (\n                      <RowItemSub\n                        role='button'\n                        className={layer.openId == menu.id ? 'active row-item' : 'row-item'}\n                        key={menu.id}\n                        onClick={e => this.getCallBackChild(menu.id, layer.index + 1, true)}\n                      >\n                        <TextSub className='txt'>{menu.name}</TextSub>\n                        { !menu.viewed && <NewItem /> }\n                      </RowItemSub>\n                    ))\n                  }\n                  {\n                    layer.documents && layer.documents.map(document => (\n                      <RowItemDocument\n                        role='button'\n                        className={layer.openId == document.id ? 'active row-item' : 'row-item'}\n                        key={document.id}\n                        onClick={e => this.openDocument(layer.parentMenuId, document.id)}\n                      >\n                        <Icon className='icon-menu'>\n                          <IconDocument documentType={document.documentType ? document.documentType : document.type} />\n                        </Icon>\n                        <TextDocument className='txt'>{document.name}</TextDocument>\n                        {\n                          document.languages && document.languages.length > 1 && (\n                          <Language>\n                            <IconLang />\n                          </Language>\n)}\n                        { !document.viewed && <NewItem /> }\n                      </RowItemDocument>\n                    ))\n                  }\n                </WrapperSideMenuPlayer>\n              ))\n            }\n          </div>\n          <div className='bottom-menu'>\n            <a href='#' onClick={() => this.logout()}>Logout</a>\n            <a className={staticValue === 'setting' ? 'active' : ''} href='/app-setting'>App Settings</a>\n            <a className={staticValue === 'term' ? 'active' : ''} href='/term-and-conditions'>Term and conditions</a>\n          </div>\n        </WrapperSideMenu>\n      </React.Fragment>\n    )\n  }\n}\n\nSideMenu.propTypes = {\n  staticValue: propTypes.string\n}\n\nconst WrapperSideMenuPlayer = styled.div`\n  background-color: ${props => props.theme.colorContent};\n  position: absolute;\n  height: 100%;\n  top: 0;\n  width: 0;\n  overflow: hidden;\n  border-right: 1px solid ${props => props.theme.colorBlue};\n  padding: 0;\n  box-sizing: border-box;\n  opacity: 1;\n  z-index: 10;\n`\n\nconst WrapperSideMenu = styled.div`\n  width: 300px;\n  flex: 1 1 auto;\n  background-color: ${props => props.theme.colorBlue};\n  position: relative;\n  padding-top: 60px;\n  min-width: 300px;\n  box-sizing: border-box;\n  border-right: 1px solid ${props => props.theme.colorBlue};\n  display: flex;\n  flex-direction: column;\n\n  .content-menu {\n    flex: 1 1 100%;\n    overflow-y: scroll;\n  }\n\n  .bottom-menu {\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    padding-left: 20px;\n    padding-bottom: 15px;\n    padding-top: 10px;\n\n    a {\n      color: ${props => props.theme.colorWhite} !important;\n      font-size: ${props => props.theme.languagesSize};\n      padding: 2px 0;\n\n      &.active {\n        font-size: 17px;\n      }\n    }\n  }\n\n  .bottom-item {\n    display: none;\n  }\n`\n\nexport default SideMenu\n"]},"metadata":{},"sourceType":"module"}